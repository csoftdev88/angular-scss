<!-- New layout - Delete old layout below when this is complete -->
<section class="hotel-detail__rooms" ng-if="rooms.length" grid-row>
  <hr />
  <div grid="12" id="jsRooms">
    <header class="section-header">

      <div class="products-not-available" ng-if="availableRooms && availableRooms.length === 0">
        <h3>_rooms_not_available_on_dates_title_</h3>
        <!-- USER SPECIFIES DATES -->
        <button-submit ng-click="selectDates()">_select_dates_</button-submit>
      </div>

      <h2 ng-bind-html="'_rooms_title_' | mainHeaderStyle"></h2>

      <!--<p ng-if="availableRooms && availableRooms.length === 0">_no_room_available_</p>-->

      <order-switch ng-if="hasDates() && availableRooms && availableRooms.length">
        <select name="sorting" ng-model="currentOrder" disable-search="true"
 chosen ng-options="option.name for option in sortingOptions" data-placeholder="_sorting_filter_placeholder_">
          <option></option> <!-- workaround for a bug in angular-chosen -->
        </select>
      </order-switch>

      <!-- search details -->
      <div class="search-details">
        <ng-pluralize class="room-counter" count="rooms.length" when="{'1': '1 _room_found_', 'other': '{} _rooms_found_'}"></ng-pluralize>
      </div>
    </header>

    <div class="rooms-preloading-container">
      <h4 class="rooms-preloading-container-title">_rates_loading_title_</h4>

      <div class="testimonial-container">

        <div class="author">
          <div class="thumbnail"><img ng-src="{{testimonial.reviewer.avatar}}" alt="review avatar"></div>
          <div class="name">{{testimonial.reviewer.name}}</div>
          <div class="city">{{testimonial.reviewer.location}}</div>
        </div>

        <div class="testimonial">
          <div class="testimonial-inner">
            <div class="desc">{{testimonial.review}}</div>
            <ul class="rating">
              <li ng-repeat="i in getNumberOfReviewStars(testimonial.stars) track by $index" class="testimonialStar"></li>
              <li ng-repeat="i in getNumberOfEmptyReviewStars(testimonial.stars) track by $index" class="testimonialStarEmpty"></li>
            </ul>
          </div>
        </div>

      </div>

      <div class="logo"></div>

      <div class="rooms-preloader"></div>

    </div>

    <list-items class="rooms-list" ng-if="ratesLoaded">
      <list-item ng-repeat="room in rooms | orderBy : currentOrder.sort | limitTo: numberOfRoomsDisplayed" data-hover-trigger="displayRoomRates(room)" data-trigger-delay="hoverTriggerDelay">
        <header class="item-header desktop">
          <h3>
            <a href ng-click="goToRoom(details.meta.slug, room.meta.slug)" ng-bind-html="room.name | mainHeaderStyle"></a>
          </h3>
          <pricing-switch ng-if="$first">
            <a href ng-class="{'is-active': pricePer === PP_NIGHT}" ng-click="setPricePer(PP_NIGHT)">_per_night_</a>
            |
            <a href
               ng-class="{'is-active': pricePer === PP_STAY, 'is-disabled': !days}"
               ng-click="days && setPricePer(PP_STAY)"
               title="{{ days ? '': 'Please select dates to enable per stay pricing'}}">
              _per_stay_
            </a>
          </pricing-switch>
        </header>

        <div class="list-item-container">
          <!-- Room info -->
          <div class="list-item-info">
            <img class="room-image desktop" ng-click="goToRoom(details.meta.slug, room.meta.slug)" ng-src="{{room.images[0].uri | cloudinaryImage : 150 : 150 : 'fill'}}" alt="{{room.name}}">
            <img class="room-image mobile" ng-click="goToRoom(details.meta.slug, room.meta.slug)" ng-src="{{room.images[0].uri | cloudinaryImage : 768 : 384 : 'fill'}}" alt="{{room.name}}">

            <header class="item-header mobile">
              <h3>
                <a href ng-click="goToRoom(details.meta.slug, room.meta.slug)" ng-bind-html="room.name | mainHeaderStyle"></a>
              </h3>
            </header>

            <ul class="amenities">
              <li class="amenity" ng-repeat="amenity in room.amenities | limitTo:numberOfAmenities">
                <slug-img slug="amenity.slug" type="room" width="15"></slug-img>
                <span class="amenity-caption">{{amenity.name}}</span>
              </li>
            </ul>
            <!--<a href ng-click="goToRoom(details.meta.slug, room.meta.slug)">Read More About this Room</a>-->
          </div>

          <room-details>
            <div class="description" ng-bind-html="sanitize(room.description)"></div>

            <div class="pricing-info">
              <div ng-if="!availableRooms || availableRooms.indexOf(room.code) > -1 && room.priceFrom">
                <p class="price-form" ng-if="room.priceFrom" itemprop="priceRange">
                  _price_from_ <span class="value">{{getValuePer(room.priceFrom) | i18nCurrency: $root.currencyCode}}</span>
                </p>
              </div>


              <div class="not-available" ng-if="!availableRooms.indexOf(room.code) > -1 && !room.priceFrom && hasDates() && ratesLoaded">
                <p>_not_available_on_dates_title_</p>
              </div>

              <div class="not-available" ng-if="!hasDates()">
                _select_dates_for_availability_title_
              </div>

              <button class="button" ng-click="displayRoomRates(room)" ng-if="!room._displayRates && availableRooms.indexOf(room.code) > -1 && room.priceFrom">_view_rates_</button>

              <!--<button class="button" ng-click="displayRoomRates(room)" ng-if="!room._displayRates">_view_rates_</button>-->
            </div>

            <p class="our-rates">_our_rates_</p>
          </room-details>




          <room-products ng-if="details && room._displayRates">
          </room-products>
        </div>
        <!-- //list-item-container -->
      </list-item>

      <a href class="display-all-rooms" ng-if="numberOfRoomsDisplayed && numberOfRoomsDisplayed < rooms.length" ng-click="displayAllRooms()">_view_all_rooms_</a>

      <a href class="display-more-rooms" ng-if="numberOfRoomsDisplayed && numberOfRoomsDisplayed < rooms.length" ng-click="displayMoreRooms()">_view_more_rooms_</a>


    </list-items>
    <h2 ng-if="!rooms.length">_no_room_found_</h2>
  </div>
</section>
