<hero-slider content="heroContent" hero-slider></hero-slider>

<breadcrumbs stickable="main-header"></breadcrumbs>

<main class="grid-wrapper">
  <div class="preloader" ng-show="preloader.visible"></div>

  <div grid="12" ng-if="isHotDeals && !showDetail">
    <p>_hot_deals_page_description_</p>
    <hr/>
  </div>

  <offers-list grid-row ng-if="!showDetail">

    <div grid="12" ng-if="config.displayPageHeading">
      <h1 ng-if="isHotDeals" ng-bind-html="'_hot_deals_' | mainHeaderStyle"></h1>
      <h1 ng-if="!isHotDeals" ng-bind-html="'_offers_deals_' | mainHeaderStyle"></h1>
    </div>

    <offer-item ng-repeat="offer in offersList track by $index" ng-if="offersList.length > 0" ng-click="goToDetail(offer.availability && offer.availability.slug && offer.availability.slug != ''  ? offer.availability.slug : offer.meta.slug)">
      <img ng-src="{{offer.image.uri | cloudinaryImage : 310 : 160 : 'fill'}}" alt="{{offer.image.alt}}"/>

      <section>
        <span class="offer-property-name" ng-if="isHotDeals && offer.propertyName">{{offer.propertyName}}</span>
        <h2>{{offer.availability && offer.availability.title && offer.availability.title != ''  ? offer.availability.title : offer.title}}</h2>
        <div ng-bind-html="offer.availability && offer.availability.subtitle && offer.availability.subtitle != ''  ? offer.availability.subtitle : offer.subtitle"></div>
      </section>

      <span class="read-more">_read_more_</span>
    </offer-item>

    <div ng-if="offersList.length === 0 && !property" class="products-not-available">
      <h3>_offers_page_no_offers_title_</h3>
      <p>_offers_page_no_offers_desc_</p>
      <a class="button" ui-sref="hotels({property: null})">_view_hotels_</a>
    </div>

    <div ng-if="offersList.length === 0 && property" class="products-not-available">
      <h3>_offers_page_no_property_offers_title_</h3>
      <p>_offers_page_no_offers_desc_</p>
    </div>


  </offers-list>

  <offer-detail id="offer-detail" grid-row ng-if="showDetail" ng-switch="!!selectDates">
    <div grid="12">
      <h1 ng-bind-html="selectedOffer.availability && selectedOffer.availability.title !== '' ? selectedOffer.availability.title : selectedOffer.title | mainHeaderStyle"></h1>
      
      <div class="offer-content">
        <img ng-src="{{selectedOffer.image.uri | cloudinaryImage : 482 : 280 : 'fill'}}" alt="{{selectedOffer.image.uri}}"/>
        <span ng-bind-html="selectedOffer.availability && selectedOffer.availability.text !== '<div></div>' && selectedOffer.availability.text !== '' ? selectedOffer.availability.text : selectedOffer.text | trustAsHtml" markdown-text-parser ng-click="bindHtmlClick($event)"></span>
        <a class="button login hide" ng-click="login()">_login_register_</a>
      </div>

      <div class="controls" ng-if="selectedOffer.availability ? selectedOffer.availability.includeBookingButton : selectedOffer.includeBookingButton">
        <div class="inner" ng-class="{'has-dropdown': config.includeOfferAvailabilityPropertyDropdown && !isHotDeals && offerAvailabilityProperties}">
          <div class="property-select" ng-show="config.includeOfferAvailabilityPropertyDropdown && !isHotDeals && offerAvailabilityProperties">
            <select
              name="propertySelect" 
              ng-model="selectedOfferAvailabilityData.selectedOfferAvailabilityProperty"
              disable-search="true"
              chosen 
              ng-options="option.slug as option.name for option in offerAvailabilityProperties" 
              data-placeholder-text-single="'Choose your hotel'">
              <option value="">Choose your hotel</option> <!-- workaround for a bug in angular-chosen -->
            </select>
          </div>

          <!-- DATES ARE SELECTED -->
          <button-submit ng-switch-when="false" ng-click="goToHotels(selectedOffer)" ng-disabled="config.includeOfferAvailabilityPropertyDropdown && !isHotDeals && !selectedOfferAvailabilityData.selectedOfferAvailabilityProperty">_book_now_ <span ng-if="isHotDeals">at {{selectedOffer.propertyName}}</span></button-submit>

          <!-- USER SPECIFIES DATES -->
          <button-submit ng-if="selectedOffer.availability ? selectedOffer.availability.includeBookingButton : selectedOffer.includeBookingButton" ng-switch-when="true" ng-click="selectDates()">_select_dates_</button-submit>
        </div>
      </div>

      <button-back role="button" tabindex="0" ng-click="goToOffersList()" class="pull-left">_back_</button-back>
    </div>
    <div grid="12">
      <hr ng-if="offersList.length > 1">

      <h2 ng-if="offersList.length > 1" ng-bind-html="'_more_offers_title_' | mainHeaderStyle"></h2>
      <offers-list ng-if="offersList.length > 1">
        <offer-item ng-repeat="offer in offersList | filter:getRelevant track by $index"  ng-click="goToDetail(offer.availability && offer.availability.slug && offer.availability.slug !== '' ? offer.availability.slug : offer.meta.slug)">
          <img ng-src="{{offer.image.uri | cloudinaryImage : 310 : 160 : 'fill'}}" alt="{{offer.image.uri}}"/>

          <section>
            <span class="offer-property-name" ng-if="isHotDeals && offer.propertyName">{{offer.propertyName}}</span>
            <h2>{{offer.availability && offer.availability.title && offer.availability.title !== '' ? offer.availability.title : offer.title}} </h2>
            <div ng-bind-html="offer.availability && offer.availability.subtitle && offer.availability.subtitle !== '' ? offer.availability.subtitle : offer.subtitle"></div>
          </section>

          <span class="read-more">_read_more_</span>
        </offer-item>
      </offers-list>
    </div>

  </offer-detail>
  <scroll-to-top class="back-to-top" ng-click="scrollToTop()" scroll-position="scroll" ng-class="{visible: scroll > scrollTopTrigger}"><span>_back_to_top_</span></scroll-to-top>
</main>
<div ng-include="'layouts/siteMap.html'" class="site-map" ng-if="footerConfig.displaySitemap"></div>
