<hero-slider content="heroContent"></hero-slider>

<breadcrumbs stickable="main-header"></breadcrumbs>

<main class="grid-wrapper">

  <div class="preloader" ng-show="preloader.visible"></div>

  <reservation-widget grid-row>

    <span id="error-msg" class="alert-warning" ng-if="invalidFormData.error">{{invalidFormData.msg}}</span>

    <div grid-row>
      <!-- RESERVATION DETAILS -->
      <div grid="7">
        <!-- SUBVIEWS -->
        <ui-view>
        </ui-view>
      </div>
      <aside grid="5">
        <section class="detail-links">
          <a href ng-click="openPriceBreakdownInfo()">View Price Breakdown</a> | <a href ng-click="readPolicies()">Policies</a>
        </section>

        <section class="room-data">
          <h4>{{property.nameLong}}</h4>

          <p class="desc"><strong>{{allRooms[0]._selectedProduct.name}}</strong></p>
          <p class="price"><strong>{{getProductPricePerNight(getTotal('totalBase')) | i18nCurrency: currencyCode}}</strong> <em>per night</em></p>
          <h3>{{allRooms[0].name}} <a href ng-click="openOtherRoomsDialog()" ng-if="allRooms.length > 1">+ {{allRooms.length - 1}} other <ng-pluralize count="allRooms.length" when="{'2': 'room', 'other': 'rooms'}"> </ng-pluralize></a></h3>

          <div class="image-wrapper">
            <img ng-src="{{allRooms[0].images[0].uri}}" alt="{{allRooms[0].name}}">
          </div>

        </section>
        <section class="reservation-data">
          <div class="data">
            <table>
              <tbody>
                <tr>
                  <th>Check in:</th>
                  <td>{{bookingDetails.from | dateTime}}</td>
                  <th>Adults:</th>
                  <td>{{getGuestsCount('adults') || 0}}</td>
                </tr>
                <tr>
                  <th>Check out:</th>
                  <td>{{bookingDetails.to | dateTime}}</td>
                  <th>Children:</th>
                  <td>{{getGuestsCount('children') || 0}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="charges">
            <table>
              <thead ng-switch="billingDetails.paymentMethod">
              <th>Room Charges:</th>
              <td>{{getTotal('totalBase') | i18nCurrency: currencyCode}}</td>
              <th rowspan="3">Total:</th>
              <td rowspan="3" ng-switch-when="cc">{{getTotal('totalAfterTax') | i18nCurrency: $root.currencyCode}}</td>
              <td rowspan="3" ng-switch-when="point">{{getTotal('pointsRequired')}} points</td>
              <td rowspan="3" ng-switch-default>{{getTotal('totalAfterTax') | i18nCurrency: $root.currencyCode}} or {{getTotal('pointsRequired')}} points</td>
              </thead>
              <tbody>
                <!-- Additional taxes -->
                <tr ng-if="getTotal('totalAdditionalTaxes')">
                  <th>Taxes:</th>
                  <td>{{getTotal('totalAfterTax') - getTotal('totalBase') | i18nCurrency: $root.currencyCode}}</td>
                </tr>

                <!-- Additional fees -->
                <tr ng-if="getTotal('totalAdditionalFees')">
                  <th>Fees:</th>
                  <td>{{getTotal('totalAdditionalFees') | i18nCurrency: $root.currencyCode}}</td>
                </tr>

                <!-- Discount -->
                <tr ng-if="getTotal('totalDiscount')">
                  <th>Discount:</th>
                  <td>{{getTotal('totalDiscount') | i18nCurrency: $root.currencyCode}}</td>
                </tr>

              </tbody>
            </table>
          </div>

        <div ng-if="state.includes('reservation.confirmation')">
          <label for="agreement1" class="input-checkbox">
            <input type="checkbox" id="agreement1" ng-model="additionalInfo.agree"/>
            I agree to the <a href ng-click="readPolicies()">Terms and Conditions</a>
          </label>

          <label for="agreement2" class="input-checkbox">
            <input type="checkbox" id="agreement2" ng-model="additionalInfo.optedIn"/>
            I am happy to receive offer via emails
          </label>
        </diV>
        </section>
      </aside>
    </div>

    <label for="agreement3" class="input-checkbox" ng-if="state.includes('reservation.details') || state.includes('reservation.billing')">
      <input type="checkbox" id="agreement3" ng-model="additionalInfo.optedIn"/>
      I agree that I am happy for the The Sutton Place Hotels to send me emails
    </label>

    <div class="reservation-controls" grid-row>
      <button class="back" ng-click="goBack()">Back</button>
      <button class="next" ng-click="continue()" ng-disabled="isContinueDisabled()">{{continueName}}</button>
      <registration-call ng-if="!isUserLoggedIn() && state.includes('reservation.details') && !isModifyingAsAnonymous()">
        <h4>Already <strong>Registered?</strong></h4>
        <p>Click here to <a href ng-click="sso.login()">log in or register</a>.</p>
      </registration-call>
    </div>
  </reservation-widget>
</main>
