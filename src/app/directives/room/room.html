<hotel-room grid="12" id="hotel-room">

  <section class="header">
    <h1 ng-bind-html="roomDetails.name | mainHeaderStyle"></h1>
  </section>

  <section ng-if="products">
    <!-- <hr class="dividerWithoutImage"/> -->
    <list-items ng-if="products.length">
      <pricing-switch>
        <a href ng-class="{'is-active': pricePer === PP_NIGHT}" ng-click="setPricePer(PP_NIGHT)">_per_night_</a>
        |
        <a href ng-class="{'is-active': pricePer === PP_STAY}" ng-click="days && setPricePer(PP_STAY)">_per_stay_</a>
      </pricing-switch>
      <list-item
        ng-repeat="product in products | orderBy : setRoomsSorting()"
        ng-class="{'is-highlighted': product.highlighted, 'is-disabled': product.memberOnly && !isUserLoggedIn()}"
        class="without-image">
        <div class="list-item-header">
          <h2 ng-bind-html="product.name | mainHeaderStyle"></h2>

          <pricing-info>
            <highlight-item ng-show="product.memberOnly && !isUserLoggedIn()">_members_only_rate_</highlight-item>
            <highlight-item ng-show="product.highlighted">_most_booked_package_</highlight-item>

            <p>
              <span class="value">{{(product.price.totalBase * (pricePer === PP_STAY ? days : 1)) | i18nCurrency: currencyCode}}</span>
              <span ng-if="pricePer === PP_NIGHT">_per_night_</span>
              <span ng-if="pricePer === PP_STAY">_per_stay_</span>

              <span ng-if="isUserLoggedIn() && product.price.pointsRequired && loyaltyProgramEnabled">
                <br />_or_ <span class="value">{{(product.price.pointsRequired * (pricePer === PP_STAY ? days : 1))}}</span> _points_
              </span>
            </p>
          </pricing-info>

          <earned-points ng-if="isUserLoggedIn() && product.price.pointsEarned && loyaltyProgramEnabled">_earn_
            <ng-pluralize count="product.price.pointsEarned"
                          when="{'1': '{} point', 'other': '{} points'}"></ng-pluralize>
          </earned-points>
        </div>

        <pricing-info>
          <highlight-item ng-show="product.memberOnly && !isUserLoggedIn()">_members_only_rate_</highlight-item>
          <highlight-item ng-show="product.highlighted">_most_booked_package_</highlight-item>

          <p>
            <span class="value">{{getValuePer(product.price.totalBase, true) | i18nCurrency: currencyCode}}</span>
            <span ng-if="pricePer === PP_NIGHT">_per_night_</span><span ng-if="pricePer === PP_STAY">_per_stay_</span>
            <span ng-if="isUserLoggedIn() && product.price.pointsRequired && loyaltyProgramEnabled">
              <br />_or_ <span class="value">{{getValuePer(product.price.pointsRequired, true)}}</span> _points_
            </span>
          </p>

          <button-submit
            role="button" tabindex="0"
            ng-click="selectProduct(product)"
            ng-hide="product.memberOnly && !isUserLoggedIn()">
            _book_now_
          </button-submit>

          <a href class="button" ng-show="product.memberOnly && !isUserLoggedIn() && !isModifyingAsAnonymous()" ng-click="sso.login()">_login_</a>
        </pricing-info>

        <description-info>
          <div>
            <!-- NOTE: API will return descriptionShort prop, full description will be used in
              room details dialogue -->
            <div ng-bind-html="sanitize(product.descriptionShort || product.description)"></div>

            <p class="action-links">
              <a href ng-click="openPriceBreakdownInfo(product)" ng-if="product.price.breakdowns.length">_view_price_breakdown_</a> &nbsp;&nbsp; | &nbsp;&nbsp;
              <a href ng-click="openPoliciesInfo([product])" ng-if="product.policies">_view_policies_</a>
               &nbsp;&nbsp; | &nbsp;&nbsp;
              <a href ng-click="openRoomDetailsDialog(product)" ng-if="openRoomDetailsDialog">_read_more_</a>
            </p>
          </div>
        </description-info>
        <div class="wide-button">
          <button-submit class="wide-button-room-details"
            role="button" tabindex="0"
            ng-click="selectProduct(product)"
            ng-hide="product.memberOnly && !isUserLoggedIn()">
            _book_now_
          </button-submit>
          <a href class="button wide-button-room-details" ng-show="product.memberOnly && !isUserLoggedIn() && !isModifyingAsAnonymous()" ng-click="sso.login()">Login</a>
        </div>
      </list-item>
    </list-items>

    <div ng-if="!products.length" class="products-not-available" ng-switch="isOverAdultsCapacity()">
      <div ng-if="$stateParams.dates">
        <div ng-switch-when="false">
          <h3>_room_not_available_on_dates_title_</h3>
          <p>_room_not_available_on_dates_desc_</p>
        </div>
        <div ng-switch-when="true">
          <h3>_not_available_on_dates_title_<br></h3>
          <p> _not_available_on_dates_desc_</p>
        </div>
      </div>

      <div ng-if="!$stateParams.dates">
        <h3>_select_dates_for_availability_title_ !</h3>
        <p>_select_dates_for_availability_desc_</p>

        <!-- USER SPECIFIES DATES -->
        <button-submit ng-click="selectDates()">_select_dates_</button-submit>
      </div>
    </div>

    <!-- <hr /> -->
  </section>


  <section class="room-description">
    <h2 ng-bind-html="'_room_description_title_' | mainHeaderStyle"></h2>
    <p ng-bind-html="sanitize(roomDetails.description)"></p>

    <ul ng-if="roomDetails.images.length > 1" class="room-gallery">
      <li class="with-special-eye-hover" ng-repeat="image in roomDetails.images" ng-click="openGallery($index)">
        <figure>
          <img ng-src="{{image.uri | cloudinaryImage : 150 : 100 : 'fill'}}" alt="{{image.alt}}" />
        </figure>
      </li>
    </ul>

    <hr />
  </section>

  <section ng-if="roomDetails.amenities.length">
    <h2 ng-bind-html="'_room_amenities_title_' | mainHeaderStyle"></h2>

    <amenities-list>
      <amenity-item ng-repeat="amenity in roomDetails.amenities">
        <slug-img slug="amenity.slug" type="room" width="15"></slug-img>
        <span class="amenity-caption">{{amenity.name}}</span>
      </amenity-item>
    </amenities-list>
    <hr/>
  </section>

  <section ng-show="property.available && otherRooms.length > 1">
    <h2 ng-bind-html="'_other_rooms_title_' | stringLocaleReplace:property.nameLong | mainHeaderStyle"></h2>

    <list-items class="grid-view">
      <list-item
        ng-repeat="otherRoom in otherRooms | orderBy:'priceFrom'"
        ng-click="onClickOnAssociatedRoom(otherRoom)"
        class="with-special-hover">
        <figure ng-show="otherRoom.images[0]">
          <img ng-src="{{otherRoom.images[0].uri | cloudinaryImage : 150 : 100 : 'fill'}}" alt="{{otherRoom.name}}">
        </figure>

        <h2>{{otherRoom.name}}</h2>

        <pricing-info>
          <p ng-if="otherRoom.priceFrom"> _price_from_ <span class="value">{{otherRoom.priceFrom | i18nCurrency: currencyCode}}</span></p>
          <p ng-if="!otherRoom.priceFrom" class="select-dates">_select_dates_for_prices_title_</p>
        </pricing-info>
      </list-item>
    </list-items>

  </section>
</hotel-room>
